<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Lecturas - Bases de Datos 2</title>
        <link rel="stylesheet" href="../styles/styles.css">
    </head>
    <body>
        <div class="menu">
            <ul>
                <a href="../index.html">Inicio</a>
                <div class="dropdown">
                    <a href="#" class="dropbtn">Lecturas</a>
                    <div class="dropdown-content">
                        <a href="funcionTot.html">Funciones de Totalización</a>
                        <a href="agrupacionDatos.html">Agrupación de Datos</a>
                        <a href="subconsultas.html">Subconsultas</a>
                        <a href="funciones.html">Funciones</a>
                        <a href="procedimientos.html">Procedimientos Almacenados</a>
                        <a href="disparadores.html">Disparadores</a>
                    </div>
                </div>
                <a href="pages/multimedia.html">Multimedia</a>
                <a href="pages/actividades.html">Actividades</a>
                <a href="pages/autores.html">Autores</a>
            </ul>
        </div>
        <div class="banner">
            <h2>OVI</h2>
            <h1>Bases de datos II</h1>
        </div>
        <div class="container">
            <div class="content">
                <h1>Lecturas - Conceptos Avanzados de Bases de Datos</h1>

                <section id="subconsultas">
                    <h2>Subconsultas</h2>
                    <img src="../img/subconsultas.jpg"
                        alt="Diagrama de subconsultas" class="section-image">

                    <p>Las subconsultas (o consultas anidadas) son consultas SQL
                        que se incluyen dentro de otra consulta. Permiten
                        realizar operaciones complejas y obtener resultados que
                        serían difíciles o imposibles con una sola consulta.</p>

                    <h3>Tipos de Subconsultas</h3>
                    <ul>
                        <li><strong>Subconsultas escalares:</strong> Devuelven
                            un único valor.</li>
                        <li><strong>Subconsultas de fila:</strong> Devuelven una
                            sola fila con múltiples columnas.</li>
                        <li><strong>Subconsultas de tabla:</strong> Devuelven
                            múltiples filas y columnas.</li>
                        <li><strong>Subconsultas correlacionadas:</strong> Hacen
                            referencia a columnas de la consulta exterior.</li>
                    </ul>

                    <h3>Ejemplos de Uso</h3>
                    <div class="code-block">
                        <pre>
-- Subconsulta escalar: Para una galería de arte, encontrar los cuadros que tienen 
un precio superior al promedio
SELECT name, listed_price
FROM paintings
WHERE listed_price > (
    SELECT AVG(listed_price)
    FROM paintings
);

-- Subconsulta de filas: Encontrar todos los coleccionistas que han comprado 
cuadros en nuestra galería
SELECT first_name, last_name
FROM collectors
WHERE id IN (
    SELECT collector_id
    FROM sales
);

-- Subconsulta de tabla: ver el importe total de las ventas de cada artista 
que ha vendido al menos un cuadro en nuestra galería
SELECT
  artists.first_name,
  artists.last_name,
  artist_sales.sales
FROM artists
JOIN (
    SELECT artist_id, SUM(sales_price) AS sales
    FROM sales
    GROUP BY artist_id
  ) AS artist_sales
  ON artists.id = artist_sales.artist_id;

-- Subconsulta correlacionada: Para cada coleccionista, calcular el 
número de cuadros comprados a través de la galería
SELECT
  artists.first_name,
  artists.last_name,
  artist_sales.sales
FROM artists
JOIN (
    SELECT artist_id, SUM(sales_price) AS sales
    FROM sales
    GROUP BY artist_id
  ) AS artist_sales
  ON artists.id = artist_sales.artist_id;
                        </pre>
                    </div>

                    <p>Las subconsultas son herramientas poderosas que permiten
                        realizar consultas complejas y obtener información
                        específica de manera eficiente.</p>

                    <p class="citation">LearnSQL. (s.f.). 5 ejemplos de
                        subconsultas SQL. LearnSQL. Recuperado de
                        <a
                            href="https://learnsql.es/blog/5-ejemplos-de-subconsultas-sql/"
                            target="_blank">learnsql.es</a>
                    </p>
                </section>
            </div>
            <div class="sidebar">
                <h2>Temas de Lectura</h2>
                <ul class="sidebar-list">
                    <li><a href="funcionTot.html">Funciones de Totalización</a></li>
                    <li><a href="agrupacionDatos.html">Agrupación de Datos</a></li>
                    <li><a href="subconsultas.html">Subconsultas</a></li>
                    <li><a href="funciones.html">Funciones</a></li>
                    <li><a href="procedimientos.html">Procedimientos Almacenados</a></li>
                    <li><a href="disparadores.html">Disparadores</a></li>
                </ul>
                
                <div class="sidebar-box">
                    <h3>Recursos de Aprendizaje</h3>
                    <p>Complementa tu estudio con estos recursos:</p>
                    <ul>
                        <li>Documentación oficial de SQL</li>
                        <li>Tutoriales interactivos</li>
                        <li>Ejemplos de código</li>
                        <li>Ejercicios prácticos</li>
                    </ul>
                </div>
                
                <div class="sidebar-box">
                    <h3>Glosario de Términos</h3>
                    <dl>
                        <dt>SQL</dt>
                        <dd>Lenguaje de consulta estructurado para bases de datos relacionales</dd>
                        <dt>SGBD</dt>
                        <dd>Sistema Gestor de Bases de Datos</dd>
                        <dt>DDL</dt>
                        <dd>Lenguaje de Definición de Datos</dd>
                        <dt>DML</dt>
                        <dd>Lenguaje de Manipulación de Datos</dd>
                    </dl>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>© 2025 Derechos reservados</p>
            <p>Desarrollado para el curso de Bases de Datos II</p>
        </div>
    </body>
</html>
